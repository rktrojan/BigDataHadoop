hive> create table orders (oid int, pid int, custid int);
hive> create external table products ( pid int, pname string, price int);

hive> drop table  products;

hive> drop table  orders;

#create table SQL
create table titanic_new(Survived int,Pclass int, Name string,Sex string,Age int,Siblings_Aboard int ,ParentsChildren_Aboard int,Fare float) row format delimited fields terminated by ','


hive> select * from titanic_new;

hive> !hdfs dfs -put titanic_noheader.csv /user/hive/warehouse/hadoop.db/titanic_new

hive> set hive.execution.engine;
#check the value--tez or mr

hive> set hive.execution.engine=mr;
hive> set hive.execution.engine=tez;
hive> set hive.execution.engine=mr;

#collect stats
hive> analyze table titanic_new  compute statistics;

hive> select count(*)  from titanic ;

hive> desc formatted titanic;

hive> select  *  from titanic_new limit 10;

hive> select count(*) from titanic_new where sex="male"

hive> select sex,count(*) from titanic_new group by sex;

hive> select pclass,sum(fare),count(age) from titanic_new group by pclass;

hive> select sum(fare),count(age) from titanic_new;

hive> select sex,count(*) from titanic_new where age>30 and survived=1 group by sex;

hive> select name from titanic_new where siblings_aboard+parentschildren_aboard>=5;

select name,siblings_aboard+parentschildren_aboard from titanic_new where siblings_aboard+parentschildren_aboard>=5;

 select * from (select name,siblings_aboard+parentschildren_aboard as dep from titanic_new where siblings_aboard+parentschildren_aboard>=5) temp order by temp.dep ;
